{"openapi":"3.0.1","info":{"title":"VALIDATION API","description":"Validation API for OPEN DATA Aplication","contact":{"name":"Andoni Salcedo Navarro","url":"ansalna@alumni.uv.es","email":"ansalna@alumni.uv.es"},"license":{"name":"Apache 2.0","url":"https://www.apache.org/licenses/LICENSE-2.0"},"version":"v1"},"servers":[{"url":"http://localhost","description":"Production"}],"paths":{"/api/v1/validator/producers/{producerId}":{"put":{"tags":["validator-controller"],"summary":"Update Producer","description":"Modificación de la información de un productor (VF3). Se podrá actualizar cualquier campo del productor a través de su identificador. Requerirá autenticación.","operationId":"updateProducer","parameters":[{"name":"producerId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProducerDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}},"delete":{"tags":["validator-controller"],"summary":"Delete Producer","description":"Eliminar un productor. Se indicará el identificador del productor. Requerirá autenticación","operationId":"deleteProducer","parameters":[{"name":"producerId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/v1/validator/producers/approve/{producerId}":{"post":{"tags":["validator-controller"],"summary":"Approve Producer","description":"Aprobar un nuevo productor. Se indicará el identificador del productor y la cuota anual. Cambiará el estado a activo. Requerirá autenticación.","operationId":"approveProducer","parameters":[{"name":"producerId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"quota","in":"query","required":true,"schema":{"type":"number","format":"double"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/v1/validator/process/{fileId}":{"post":{"tags":["validator-controller"],"summary":"Prepare And Publish File","description":"Preparación y publicación de un fichero. Se indicará el identificador del fichero y se cambiará su estado a “en preparación”. Se enviará un mensaje a una cola en RabbitMQ para que se realice una tarea de procesamiento previa a la publicación. El  mensaje será atendido por un servicio de procesado (balanceado entre 4 instancias)  que implementará una espera en función del tamaño del fichero con el objetivo de emular la ejecución de un conjunto de acciones de larga duración. Tras este procesamiento se cambiará el estado a publicado. Si el productor especificó la palabra clave “error”, simularemos que se ha producido un error en la tarea de  procesamiento y el estado cambiará a erróneo. Requerirá autenticació.","operationId":"prepareAndPublishFile","parameters":[{"name":"fileId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"x-auth-user-id","in":"header","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/v1/validator/producers":{"get":{"tags":["validator-controller"],"summary":"Get Producers","description":"Obtener el listado de productores. Si no se indica ningún filtro se devolverá todo el listado de productores. Opcionalmente se pueden indicar los siguientes filtros: solo pendientes de aprobación, solo los que haya consumido su cuota anual o solo los que tengan algún fichero erróneo. Requerirá autenticación.","operationId":"getProducers","parameters":[{"name":"filter","in":"query","description":"Filtro opcional. Puede ser 'unapproved' (solo pendientes de aprobación), 'quota_exceeded' (solo los que haya consumido su cuota anual), o 'error_files' (solo los que tengan algún fichero erróneo).","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ProducerDTO"}}}}}}}},"/api/v1/validator/files/pending":{"get":{"tags":["validator-controller"],"summary":"Get Files Pending Review","description":"Obtener el listado de ficheros pendientes de revisión. Para cada fichero se obtendrá el identificador, título, descripción, nombre del productor y las primeras 10 observaciones. Requerirá autenticación.","operationId":"getFilesPendingReview","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/FileDTO"}}}}}}}}},"components":{"schemas":{"ProducerDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"state":{"type":"boolean"},"quota":{"type":"number","format":"double"},"nif":{"type":"string"},"name":{"type":"string"},"email":{"type":"string"},"password":{"type":"string"},"type":{"type":"string"}}},"FileDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"creationDate":{"type":"string","format":"date-time"},"state":{"type":"string"},"numViews":{"type":"integer","format":"int32"},"numDownloads":{"type":"integer","format":"int32"},"producer":{"$ref":"#/components/schemas/ProducerDTO"},"validator":{"$ref":"#/components/schemas/UserDTO"},"title":{"type":"string"},"description":{"type":"string"},"keyWords":{"type":"array","items":{"type":"string"}},"size":{"type":"integer","format":"int32"}}},"UserDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"name":{"type":"string"},"email":{"type":"string"},"password":{"type":"string"},"role":{"type":"string"}}}}}}